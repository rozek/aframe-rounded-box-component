{"version":3,"file":"aframe-rounded-box-component.esm.js","sources":["../src/aframe-rounded-box-component.ts"],"sourcesContent":["  declare const AFRAME:any, THREE:any\n\n/**** (re)define a component for A-Frame ****/\n\n  delete AFRAME.components['rounded-box']\n\n  AFRAME.registerComponent('rounded-box', {\n    schema: {\n      'width':   { type:'number', default:1 },\n      'height':  { type:'number', default:1 },\n      'depth':   { type:'number', default:1 },\n      'radius':  { type:'number', default:0.1 },\n      'segments':{ type:'int',    default:3 }\n    },\n\n  /**** init ****/\n\n    init: function (oldData:any):void {\n      let Geometry = new THREE.BufferGeometry()\n      let Material = new THREE.MeshStandardMaterial()\n      let Mesh     = new THREE.Mesh(Geometry,Material)\n      this.el.setObject3D('mesh', Mesh)\n    },\n\n  /**** update ****/\n\n    update: function (oldData:any):void {\n      let { width,height,depth, radius, segments} = this.data\n\n      if (\n        (oldData == null) ||\n        (width !== oldData.width) || (height !== oldData.height) ||\n        (depth !== oldData.depth) || (radius !== oldData.radius) ||\n        (segments !== oldData.segments)\n      ) {\n        radius = Math.min(radius, width/2,height/2,depth/2)*0.9999\n\n        let Shape = new THREE.Shape()\n          Shape.absarc(radius,      radius,        radius, -Math.PI/2,-Math.PI, true)\n          Shape.absarc(radius,      height-radius, radius, Math.PI,Math.PI/2,   true)\n          Shape.absarc(width-radius,height-radius, radius, Math.PI/2,0,         true)\n          Shape.absarc(width-radius,radius,        radius, 0,-Math.PI/2,        true)\n        let Geometry = new THREE.ExtrudeBufferGeometry(Shape, {\n          depth:depth-2*radius,\n          bevelEnabled:true,\n          bevelThickness:radius, bevelSize:radius, bevelOffset:-radius,\n          bevelSegments:2*segments, curveSegments:segments\n        })\n          Geometry.center()\n        this.el.getObject3D('mesh').geometry = Geometry\n      }\n    },\n\n  /**** remove ****/\n\n    remove: function ():void {\n      this.el.removeObject3D('mesh')\n    }\n  })\n\n/**** define a primitive for the \"rounded-box\" component (if not already present) ****/\n\n  if (AFRAME.primitives.primitives['a-rounded-box'] == null) {\n    AFRAME.registerPrimitive('a-rounded-box', {\n      defaultComponents: {\n        'rounded-box':{}\n      },\n\n      mappings: {\n        width:   'rounded-box.width',\n        height:  'rounded-box.height',\n        depth:   'rounded-box.depth',\n        radius:  'rounded-box.radius',\n        segments:'rounded-box.segments',\n      }\n    })\n  } else {\n    console.warn('an A-Frame primitive called \"a-rounded-box\" exists already')\n  }\n\n"],"names":[],"mappings":"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"}