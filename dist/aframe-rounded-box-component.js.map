{"version":3,"file":"aframe-rounded-box-component.js","sources":["../src/aframe-rounded-box-component.ts"],"sourcesContent":["  declare const AFRAME:any, THREE:any\n\n/**** (re)define a component for A-Frame ****/\n\n  delete AFRAME.components['rounded-box']\n\n  AFRAME.registerComponent('rounded-box', {\n    schema: {\n      'width':   { type:'number', default:1 },\n      'height':  { type:'number', default:1 },\n      'depth':   { type:'number', default:1 },\n      'radius':  { type:'number', default:0.1 },\n      'segments':{ type:'int',    default:3 }\n    },\n\n  /**** init ****/\n\n    init: function (oldData:any):void {\n      let Geometry = new THREE.BufferGeometry()\n      let Material = new THREE.MeshStandardMaterial()\n      let Mesh     = new THREE.Mesh(Geometry,Material)\n      this.el.setObject3D('mesh', Mesh)\n    },\n\n  /**** update ****/\n\n    update: function (oldData:any):void {\n      let { width,height,depth, radius, segments} = this.data\n\n      if (\n        (oldData == null) ||\n        (width !== oldData.width) || (height !== oldData.height) ||\n        (depth !== oldData.depth) || (radius !== oldData.radius) ||\n        (segments !== oldData.segments)\n      ) {\n        radius = Math.min(radius, width/2,height/2,depth/2)*0.9999\n\n        let Shape = new THREE.Shape()\n          Shape.absarc(radius,      radius,        radius, -Math.PI/2,-Math.PI, true)\n          Shape.absarc(radius,      height-radius, radius, Math.PI,Math.PI/2,   true)\n          Shape.absarc(width-radius,height-radius, radius, Math.PI/2,0,         true)\n          Shape.absarc(width-radius,radius,        radius, 0,-Math.PI/2,        true)\n        let Geometry = new THREE.ExtrudeBufferGeometry(Shape, {\n          depth:depth-2*radius,\n          bevelEnabled:true,\n          bevelThickness:radius, bevelSize:radius, bevelOffset:-radius,\n          bevelSegments:2*segments, curveSegments:segments\n        })\n          Geometry.center()\n        this.el.getObject3D('mesh').geometry = Geometry\n      }\n    },\n\n  /**** remove ****/\n\n    remove: function ():void {\n      this.el.removeObject3D('mesh')\n    }\n  })\n\n/**** define a primitive for the \"rounded-box\" component (if not already present) ****/\n\n  if (AFRAME.primitives.primitives['a-rounded-box'] == null) {\n    AFRAME.registerPrimitive('a-rounded-box', {\n      defaultComponents: {\n        'rounded-box':{}\n      },\n\n      mappings: {\n        width:   'rounded-box.width',\n        height:  'rounded-box.height',\n        depth:   'rounded-box.depth',\n        radius:  'rounded-box.radius',\n        segments:'rounded-box.segments',\n      }\n    })\n  } else {\n    console.warn('an A-Frame primitive called \"a-rounded-box\" exists already')\n  }\n\n"],"names":["AFRAME","components","registerComponent","schema","width","type","default","height","depth","radius","segments","init","oldData","Geometry","THREE","BufferGeometry","Material","MeshStandardMaterial","Mesh","this","el","setObject3D","update","_a","data","Math","min","Shape","absarc","PI","ExtrudeBufferGeometry","bevelEnabled","bevelThickness","bevelSize","bevelOffset","bevelSegments","curveSegments","center","getObject3D","geometry","remove","removeObject3D","primitives","registerPrimitive","defaultComponents","mappings","console","warn"],"mappings":"gCAISA,OAAOC,WAAW,eAEzBD,OAAOE,kBAAkB,cAAe,CACtCC,OAAQ,CACNC,MAAW,CAAEC,KAAK,SAAUC,QAAQ,GACpCC,OAAW,CAAEF,KAAK,SAAUC,QAAQ,GACpCE,MAAW,CAAEH,KAAK,SAAUC,QAAQ,GACpCG,OAAW,CAAEJ,KAAK,SAAUC,QAAQ,IACpCI,SAAW,CAAEL,KAAK,MAAUC,QAAQ,IAKtCK,KAAM,SAAUC,GACd,IAAIC,EAAW,IAAIC,MAAMC,eACrBC,EAAW,IAAIF,MAAMG,qBACrBC,EAAW,IAAIJ,MAAMI,KAAKL,EAASG,GACvCG,KAAKC,GAAGC,YAAY,OAAQH,EAC7B,EAIDI,OAAQ,SAAUV,GACZ,IAAAW,EAA0CJ,KAAKK,KAA7CpB,UAAMG,WAAOC,UAAOC,WAAQC,aAElC,GACc,MAAXE,GACAR,IAAUQ,EAAQR,OAAWG,IAAWK,EAAQL,QAChDC,IAAUI,EAAQJ,OAAWC,IAAWG,EAAQH,QAChDC,IAAaE,EAAQF,SACtB,CACAD,EAAoD,MAA3CgB,KAAKC,IAAIjB,EAAQL,EAAM,EAAEG,EAAO,EAAEC,EAAM,GAEjD,IAAImB,EAAQ,IAAIb,MAAMa,MACpBA,EAAMC,OAAOnB,EAAaA,EAAeA,GAASgB,KAAKI,GAAG,GAAGJ,KAAKI,IAAI,GACtEF,EAAMC,OAAOnB,EAAaF,EAAOE,EAAQA,EAAQgB,KAAKI,GAAGJ,KAAKI,GAAG,GAAK,GACtEF,EAAMC,OAAOxB,EAAMK,EAAOF,EAAOE,EAAQA,EAAQgB,KAAKI,GAAG,EAAE,GAAW,GACtEF,EAAMC,OAAOxB,EAAMK,EAAOA,EAAeA,EAAQ,GAAGgB,KAAKI,GAAG,GAAU,GACxE,IAAIhB,EAAW,IAAIC,MAAMgB,sBAAsBH,EAAO,CACpDnB,MAAMA,EAAM,EAAEC,EACdsB,cAAa,EACbC,eAAevB,EAAQwB,UAAUxB,EAAQyB,aAAazB,EACtD0B,cAAc,EAAEzB,EAAU0B,cAAc1B,IAExCG,EAASwB,SACXlB,KAAKC,GAAGkB,YAAY,QAAQC,SAAW1B,CACxC,CACF,EAID2B,OAAQ,WACNrB,KAAKC,GAAGqB,eAAe,OACxB,IAKkD,MAAjDzC,OAAO0C,WAAWA,WAAW,iBAC/B1C,OAAO2C,kBAAkB,gBAAiB,CACxCC,kBAAmB,CACjB,cAAc,CAAE,GAGlBC,SAAU,CACRzC,MAAS,oBACTG,OAAS,qBACTC,MAAS,oBACTC,OAAS,qBACTC,SAAS,0BAIboC,QAAQC,KAAK"}